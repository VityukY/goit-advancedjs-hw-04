{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst requestHandler = async (request, page) => {\n  const result = await axios.get(\n    `https://pixabay.com/api/?key=20439634-6c644a175487626659667f77f&q=${request}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`\n  );\n  return result;\n};\n\nexport { requestHandler };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { requestHandler } from './js/api';\n\nconst formRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst loadBrnRef = document.querySelector('.load-more');\n\nlet page = 1;\nlet searchQuery = '';\nconst lightbox = new SimpleLightbox('.gallery a', {});\n\nloadBrnRef.addEventListener('click', e => {\n  page += 1;\n  galleryHandler(searchQuery, page);\n});\n\nformRef.addEventListener('submit', e => {\n  e.preventDefault();\n  page = 1;\n  loadBrnRef.classList.add('hidden');\n  galleryRef.innerHTML = '';\n  searchQuery = formRef.searchQuery.value;\n  if (searchQuery == '') {\n    iziToast.warning({\n      title: 'No request',\n      message: 'Please add query for request',\n    });\n    return;\n  }\n  galleryHandler(searchQuery, page);\n});\n\nfunction galleryHandler(searchQuery, page) {\n  const serchData = requestHandler(searchQuery, page);\n  serchData\n    .then(result => {\n      if (result.data.totalHits == 0) {\n        throw error;\n      }\n      if (page == 1) {\n        iziToast.success({\n          title: 'Success',\n          message: `Hooray! We found ${result.data.totalHits} images.`,\n        });\n      }\n      return result.data;\n    })\n    .then(data => {\n      const galleryItems = data.hits.map(elem => {\n        return createCard(elem);\n      });\n      galleryRef.append(...galleryItems);\n      lightbox.refresh();\n\n      if (galleryItems.length > 0) {\n        const firstItem = galleryItems[0];\n        const headerHeight = 120;\n        const topPosition = firstItem.offsetTop - headerHeight;\n        window.scrollTo({\n          top: topPosition,\n          behavior: 'smooth',\n        });\n      }\n      if (endHitsCheker(data.totalHits, galleryRef)) {\n        loadBrnRef.classList.remove('hidden');\n      } else {\n        iziToast.warning({\n          title: 'End of list',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n        loadBrnRef.classList.add('hidden');\n      }\n    })\n    .catch(error => {\n      loadBrnRef.classList.add('hidden');\n      iziToast.error({\n        title: 'No matches',\n        message: 'No matches with you request',\n      });\n    });\n}\n\nfunction endHitsCheker(totalHits, galleryRef) {\n  let childNodes = galleryRef.childNodes;\n  let numberOfChildNodes = childNodes.length;\n  if (totalHits == numberOfChildNodes) {\n    return false;\n  }\n  return true;\n}\n\nfunction createCard(data) {\n  // Create the main card container\n  const card = document.createElement('a');\n  card.classList.add('photo-card');\n  card.href = data.largeImageURL;\n\n  // Create the image element\n  const img = document.createElement('img');\n  img.src = data.webformatURL;\n  img.alt = data.tags;\n  img.loading = 'lazy';\n  // Append the image to the card\n  card.appendChild(img);\n\n  // Create the info container\n  const info = document.createElement('div');\n  info.classList.add('info');\n\n  // Create the likes element\n  const likes = document.createElement('p');\n  likes.classList.add('info-item');\n  likes.innerHTML = `<b>${data.likes}<br>Likes</br>`;\n  info.appendChild(likes);\n\n  // Create the views element\n  const views = document.createElement('p');\n  views.classList.add('info-item');\n  views.innerHTML = `<b>${data.views}<br>Views</b>`;\n  info.appendChild(views);\n\n  // Create the comments element\n  const comments = document.createElement('p');\n  comments.classList.add('info-item');\n  comments.innerHTML = `<b>${data.comments}<br>Comments</b>`;\n  info.appendChild(comments);\n\n  // Create the downloads element\n  const downloads = document.createElement('p');\n  downloads.classList.add('info-item');\n  downloads.innerHTML = `<b>${data.downloads}<br>Downloads</b>`;\n  info.appendChild(downloads);\n\n  // Append the info container to the card\n  card.appendChild(info);\n\n  return card;\n}\n"],"names":["requestHandler","request","page","axios","formRef","galleryRef","loadBrnRef","searchQuery","lightbox","SimpleLightbox","e","galleryHandler","iziToast","result","data","galleryItems","elem","createCard","firstItem","headerHeight","topPosition","endHitsCheker","error","totalHits","numberOfChildNodes","card","img","info","likes","views","comments","downloads"],"mappings":"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"}